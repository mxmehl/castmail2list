{% extends "base.html" %}

{% block title %}Subscribers - {{ mailing_list.name }}{% endblock %}

{% block content %}

<h2>Subscribers for "{{ mailing_list.name }}"</h2>

<h3>Add Subscriber</h3>
<form method="POST">
    {{ add_form.hidden_tag() }}

    {{ add_form.email.label }}
    {{ add_form.email }}
    {% if add_form.email.errors %}
    <div class="text-danger">
        {% for error in add_form.email.errors %}
        <small>{{ error }}</small>
        {% endfor %}
    </div>
    {% endif %}

    {{ add_form.add_subscriber }}
</form>
</div>

<h3>Current Subscribers ({{ mailing_list.subscribers|length }})</h3>
{% if mailing_list.subscribers %}
<div>
    {% for subscriber in mailing_list.subscribers %}
    <div>
        <span>{{ subscriber.email }}</span>
        <form method="POST">
            {{ delete_form.hidden_tag() }}
            {{ delete_form.subscriber_id(value=subscriber.id) }}
            {{ delete_form.delete_subscriber(onclick="return confirm('Are you sure you want to remove this subscriber?')") }}
        </form>
    </div>
    {% endfor %}
</div>
{% else %}
<p class="text-muted">No subscribers yet.</p>
{% endif %}
</div>
</div>
{% endblock %}
